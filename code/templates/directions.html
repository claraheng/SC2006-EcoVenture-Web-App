<!DOCTYPE html>
<html>
<head>
	<title>Directions Request from Current Location</title>
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBiGsmX06pkCBB0-AGc0f76kXr0SuoraKQ"></script>
	<script>
		function initMap() {
			var directionsService = new google.maps.DirectionsService();
			var directionsDisplay = new google.maps.DirectionsRenderer();
			var map = new google.maps.Map(document.getElementById('map'), {
				zoom: 14,
				center: {lat: 1.3521, lng: 103.8198} // Singapore coordinates
			});
			directionsDisplay.setMap(map);

			// Get user's current location
			if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(function(position) {
					var userLocation = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
					var destination = '{{ travel.destination }}';

					// Get selected travel mode
					var travelMode = document.getElementById('travel-mode').value;

					// Create request object
					var request = {
						origin: userLocation,
						destination: destination,
						travelMode: travelMode
					};

					// Send request to Google Maps API
					directionsService.route(request, function(result, status) {
						if (status == 'OK') {
							directionsDisplay.setDirections(result);
						}
					});
				}, function() {
					alert('Unable to determine your location.');
				});
			} else {
				alert('Your browser does not support geolocation.');
			}
		}

		document.addEventListener('DOMContentLoaded', function() {
			document.getElementById('travel-mode').addEventListener('change', function() {
				initMap();
			});
			initMap();
		});
	</script>
 </head>
<body> 
	<form>
		<label for="travel-mode">Travel mode:</label>
		<select id="travel-mode">
		  <option value="DRIVING">Driving</option>
		  <option value="BICYCLING">Bicycling</option>
		  <option value="TRANSIT">Transit</option>
		  <option value="WALKING">Walking</option>
		</select>
	</form>
	<div id="map" style="height: 500px; width: 100%;"></div>
 </body>
</html>
